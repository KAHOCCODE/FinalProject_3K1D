@{
    Layout = null;

    // Check if all values are "Unknown"
    bool allUnknown = ViewBag.MovieTitle == "Unknown" &&
                      ViewBag.Showtime == "Unknown" &&
                      ViewBag.Room == "Unknown" &&
                      ViewBag.CustomerName == "Unknown" &&
                      ViewBag.Price == "Unknown";
}
@Html.AntiForgeryToken()
@if (!allUnknown)
{
            <link rel="stylesheet" href="~/css/huyve.css" asp-append-version="true" />
            <!-- Background overlay -->
            <div class="overlay"></div>

            <!-- Modal for ticket details -->
            <div class="modal-container">
                <div class="ticket-modal">
                    <div class="modal-header">
                        <h2 class="movie-title">@ViewBag.MovieTitle</h2>
                    </div>
                    <div class="modal-body">
                        <p class="ticket-id"><strong>Mã vé:</strong> @ViewBag.IdVe</p>
                        <p class="showtime"><strong>Giờ chiếu:</strong> @ViewBag.Showtime</p>
                        <p class="room"><strong>Phòng chiếu:</strong> @ViewBag.Room</p>
                        <p class="room"><strong>Mã ghế ngồi:</strong> @ViewBag.IdSeat</p>
                        <p class="customer-name"><strong>Tên khách hàng:</strong> @ViewBag.CustomerName</p>
                        <p class="price"><strong>Giá tiền:</strong> @ViewBag.Price VND</p>
                    </div>
                    <div class="modal-footer">
                        <button class="cancel-button" onclick="cancelTicket(@ViewBag.IdVe)">Hủy vé</button>
                    </div>
                </div>
            </div>
        <script>
        function cancelTicket(idVe) {
            if (confirm("Bạn có chắc muốn hủy vé này?")) {
                // Get the anti-forgery token
                var token = document.querySelector('input[name="__RequestVerificationToken"]').value;

                // Make an AJAX request to cancel the ticket
                fetch('/Home/CancelTicket', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'RequestVerificationToken': token
                    },
                    body: JSON.stringify({ idVe: idVe })
                })
                .then(response => {
                    if (response.ok) {
                        alert("Vé đã được hủy thành công.");
                        window.location.href = '/Home/Index'; // Redirect to the homepage after successful cancellation
                    } else {
                        alert("Có lỗi xảy ra khi hủy vé. Vui lòng thử lại.");
                    }
                })
                .catch(error => console.error('Error:', error));
            }
        }
    </script>


}
else
{
            <p>Không có dữ liệu vé để hiển thị.</p>
}
