@model FinalProject_3K1D.Models.DashboardViewModel

@{
    ViewData["Title"] = "Bảng Điều Khiển";
    Layout = "~/Areas/Admin/Views/Shared/_LayoutAdmin.cshtml";
}

<!-- Thêm nền phong cách -->
<div class="dashboard-container" style="background: linear-gradient(to right, #f9f9f9, #e2e2e2); padding: 2rem 0;">
    <h1 class="mb-4 text-center fw-bold" style="color: #6A0DAD;">Tổng Quan Bảng Điều Khiển</h1>

    <div class="container">
        <div class="row g-4">
            <!-- Tổng số khách hàng -->
            <div class="col-md-6 col-lg-3">
                <div class="card shadow-lg border-0 rounded-lg text-center" style="background-color: #E6E6FA; transition: transform 0.3s ease;">
                    <div class="card-body py-4">
                        <i class="fas fa-users fa-3x mb-3" style="color: #6A0DAD;"></i>
                        <h5 class="fw-bold" style="color: #6A0DAD;">Tổng số khách hàng</h5>
                        <h3 class="display-5 fw-bold" style="color: #6A0DAD;">@Model.TotalCustomers</h3>
                    </div>
                </div>
            </div>

            <!-- Tổng số nhân viên -->
            <div class="col-md-6 col-lg-3">
                <div class="card shadow-lg border-0 rounded-lg text-center" style="background-color: #FFFACD; transition: transform 0.3s ease;">
                    <div class="card-body py-4">
                        <i class="fas fa-user-tie fa-3x mb-3" style="color: #FFD700;"></i>
                        <h5 class="fw-bold" style="color: #FFD700;">Tổng số nhân viên</h5>
                        <h3 class="display-5 fw-bold" style="color: #FFD700;">@Model.TotalEmployees</h3>
                    </div>
                </div>
            </div>

            <!-- Tổng số phim -->
            <div class="col-md-6 col-lg-3">
                <div class="card shadow-lg border-0 rounded-lg text-center" style="background-color: #F0F8FF; transition: transform 0.3s ease;">
                    <div class="card-body py-4">
                        <i class="fas fa-film fa-3x mb-3" style="color: #9370DB;"></i>
                        <h5 class="fw-bold" style="color: #9370DB;">Tổng số phim</h5>
                        <h3 class="display-5 fw-bold" style="color: #9370DB;">@Model.TotalMovies</h3>
                    </div>
                </div>
            </div>

            <!-- Doanh thu theo rạp -->
            <div class="col-md-12">
                <div class="card shadow-lg border-0 rounded-lg">
                    <div class="card-header text-center" style="background-color: #6A0DAD; color: #fff;">
                        <h5 class="fw-bold mb-0">Doanh Thu Theo Rạp</h5>
                    </div>
                    <div class="card-body p-4">
                        <canvas id="revenueChart" style="max-height: 300px;"></canvas>
                    </div>
                </div>
            </div>

            <!-- Top 3 phim có doanh thu cao nhất theo từng rạp -->
            <div class="col-md-12 mt-4">
                <div class="card shadow-lg border-0 rounded-lg">
                    <div class="card-header text-center" style="background-color: #6A0DAD; color: #fff;">
                        <h5 class="fw-bold mb-0">Top 3 Phim Có Doanh Thu Cao Nhất Theo Rạp</h5>
                    </div>
                    <div class="card-body">
                        @if (Model.TopMoviesByTheater != null && Model.TopMoviesByTheater.Any())
                        {
                            <div class="row">
                                @foreach (var theater in Model.TopMoviesByTheater)
                                {
                                    <div class="col-md-6 mb-4">
                                        <h6 class="fw-bold mb-3">@theater.TheaterName</h6>
                                        <ul class="list-group">
                                            @foreach (var movie in theater.TopMovies)
                                            {
                                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                                    @movie.MovieTitle
                                                    <span class="badge bg-primary rounded-pill">
                                                        @String.Format("{0:N0} VND", movie.TotalRevenue)
                                                    </span>
                                                </li>
                                            }
                                        </ul>
                                    </div>
                                }
                            </div>
                        }
                        else
                        {
                            <p>Không có dữ liệu phim.</p>
                        }
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://kit.fontawesome.com/a076d05399.js"></script> <!-- FontAwesome for icons -->
<script>
    document.addEventListener('DOMContentLoaded', function () {
        var ctx = document.getElementById('revenueChart').getContext('2d');
        var chart = new Chart(ctx, {
            type: 'bar', // Thay đổi loại biểu đồ
            data: {
                labels: @Html.Raw(Newtonsoft.Json.JsonConvert.SerializeObject(Model.RevenueByTheater.Keys)),
                datasets: [{
                    data: @Html.Raw(Newtonsoft.Json.JsonConvert.SerializeObject(Model.RevenueByTheater.Values)),
                    backgroundColor: '#6A0DAD',
                    borderColor: '#fff',
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: true,
                aspectRatio: 1.5,
                plugins: {
                    legend: {
                        display: true,
                        position: 'bottom',
                        labels: {
                            color: '#333',
                            font: {
                                size: 14
                            }
                        }
                    },
                    tooltip: {
                        backgroundColor: 'rgba(0, 0, 0, 0.8)',
                        titleColor: '#fff',
                        bodyColor: '#fff',
                        callbacks: {
                            label: function (context) {
                                let label = context.label || '';
                                let value = context.raw || 0;
                                return `${label}: ${new Intl.NumberFormat('vi-VN', { style: 'currency', currency: 'VND' }).format(value)}`;
                            }
                        }
                    }
                },
                scales: {
                    x: {
                        ticks: {
                            color: '#333'
                        },
                        grid: {
                            display: false
                        }
                    },
                    y: {
                        ticks: {
                            color: '#333'
                        },
                        grid: {
                            color: '#ddd'
                        }
                    }
                }
            }
        });
    });
</script>
